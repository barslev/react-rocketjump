(window.webpackJsonp=window.webpackJsonp||[]).push([[40],{110:function(e,n,t){"use strict";t.r(n),t.d(n,"frontMatter",(function(){return a})),t.d(n,"metadata",(function(){return c})),t.d(n,"toc",(function(){return s})),t.d(n,"default",(function(){return u}));var o=t(3),i=t(7),r=(t(0),t(123)),a={id:"api_configure",title:"Sharing configuration",sidebar_label:"Sharing configuration",slug:"/api-config"},c={unversionedId:"api_configure",id:"version-2.x/api_configure",isDocsHomePage:!1,title:"Sharing configuration",description:"A strong use case for React-RocketJump is to manage asynchronous interaction with backend APIs, which are, usually, authenticated. As we have seen in the section about the RocketJump constructor, this can be achieved easily by using the effectCaller configuration key. However, you still have to specify the effectCaller key in almost all your RocketJump Object defintions, which can be tedious and error prone. For this reason, React-RocketJump ships with a component which can be used to share a common configuration among different RocketJump objects. This component is called ConfigureRj.",source:"@site/versioned_docs/version-2.x/api_configure.md",slug:"/api-config",permalink:"/react-rocketjump/docs/api-config",editUrl:"https://github.com/inmagik/react-rocketjump/edit/master/website/versioned_docs/version-2.x/api_configure.md",version:"2.x",sidebar_label:"Sharing configuration",sidebar:"version-2.x/someSidebar",previous:{title:"RocketJump constructor",permalink:"/react-rocketjump/docs/api-rj"},next:{title:"RocketJump Composition",permalink:"/react-rocketjump/docs/api-composition"}},s=[{value:"How it works?",id:"how-it-works",children:[]},{value:"Sharable properties",id:"sharable-properties",children:[]},{value:"Example",id:"example",children:[]}],p={toc:s};function u(e){var n=e.components,t=Object(i.a)(e,["components"]);return Object(r.b)("wrapper",Object(o.a)({},p,t,{components:n,mdxType:"MDXLayout"}),Object(r.b)("p",null,"A strong use case for React-RocketJump is to manage asynchronous interaction with backend APIs, which are, usually, authenticated. As we have seen in the section about the ",Object(r.b)("a",{parentName:"p",href:"/react-rocketjump/docs/api-rj"},"RocketJump constructor"),", this can be achieved easily by using the ",Object(r.b)("inlineCode",{parentName:"p"},"effectCaller")," configuration key. However, you still have to specify the ",Object(r.b)("inlineCode",{parentName:"p"},"effectCaller")," key in almost all your RocketJump Object defintions, which can be tedious and error prone. For this reason, React-RocketJump ships with a component which can be used to share a common configuration among different RocketJump objects. This component is called ",Object(r.b)("inlineCode",{parentName:"p"},"ConfigureRj"),"."),Object(r.b)("p",null,"This is quite different from composition, since composition is described in RocketJump Objects definition, while this configuration is injected in RocketJump objects when they are connected to a component."),Object(r.b)("h2",{id:"how-it-works"},"How it works?"),Object(r.b)("p",null,"The ",Object(r.b)("inlineCode",{parentName:"p"},"ConfigureRj")," component can inject some configuration keys in RocketJump Objects that are connected to components in its subtree. This means that you can have multiple ",Object(r.b)("inlineCode",{parentName:"p"},"<ConfigureRj />")," components in your application, each one injecting a different configuration in a different subtree. ",Object(r.b)("inlineCode",{parentName:"p"},"<ConfigureRj />")," is implemented with React's ",Object(r.b)("inlineCode",{parentName:"p"},"context")," api, hence ",Object(r.b)("inlineCode",{parentName:"p"},"<ConfigureRj />")," components can also be nested, but be careful that differenct ",Object(r.b)("inlineCode",{parentName:"p"},"<ConfigureRj />")," components does not compose: the nearest parent wins."),Object(r.b)("p",null,"Properties configured by ",Object(r.b)("inlineCode",{parentName:"p"},"<ConfigureRj />")," are injected in a ",Object(r.b)("inlineCode",{parentName:"p"},"RocketJump object")," if and only if it accepts them explicitly by defining the configuration key in its configuration and assigning it the special value ",Object(r.b)("inlineCode",{parentName:"p"},"rj.configured()")),Object(r.b)("h2",{id:"sharable-properties"},"Sharable properties"),Object(r.b)("p",null,"By now, the capability of ",Object(r.b)("inlineCode",{parentName:"p"},"<ConfigureRj />")," is limited to the ",Object(r.b)("inlineCode",{parentName:"p"},"effectCaller")," property. Introducing in the tree a ",Object(r.b)("inlineCode",{parentName:"p"},"<ConfigureRj />")," component with the ",Object(r.b)("inlineCode",{parentName:"p"},"effectCaller")," property set means that any component using a RocketJump Object (both with the ",Object(r.b)("inlineCode",{parentName:"p"},"connectRj")," hoc or the ",Object(r.b)("inlineCode",{parentName:"p"},"useRj")," hook) will inherit the ",Object(r.b)("inlineCode",{parentName:"p"},"effectCaller")," unless you explicitly define it in the RocketJump Object definition"),Object(r.b)("pre",null,Object(r.b)("code",{parentName:"pre",className:"language-js"},"<ConfigureRj effectCaller={myCustomEffectCaller}>\n    /* This is the scope of the shared configuration */\n</ConfigureRj>\n")),Object(r.b)("h2",{id:"example"},"Example"),Object(r.b)("p",null,"This example shows how you can use the ",Object(r.b)("inlineCode",{parentName:"p"},"<ConfigureRj />")," API to easily implement authentication"),Object(r.b)("pre",null,Object(r.b)("code",{parentName:"pre",className:"language-js"},"// localstate.js\nimport { rj } from \"react-rocketjump\"\n\nconst MyCustomRj = rj({\n  effect: doSomethingAsync,\n  // the following allows a <ConfigureRj /> component to inject\n  // configuration into this RocketJump Object when it is used\n  // in a component nested inside the same <ConfigureRj />\n  effectCaller: rj.configured()\n})\n\n// my-component.js\nimport React from 'react'\nimport { ConfigureRj } from 'react-rocketjump'\n\nconst AuthContext = React.createContext(null)\n\nclass AuthWrapper extends React.Component {\n  state = {\n    user: null,\n    authToken: null,\n  }\n\n  // ...\n\n  injectAuth = (apiCall, ...params) =>\n    apiCall(...params, this.state.authToken)\n\n  render() {\n    return (\n      <AuthContext.Provider value={{\n        user: this.state.user,\n        login: this.performLogin,\n        // ....\n      }}>\n        <ConfigureRj effectCaller={this.injectAuth}>\n          {this.props.children}\n        </ConfigureRj>\n      </AuthContext.Provider>\n    )\n  }\n}\n")))}u.isMDXComponent=!0},123:function(e,n,t){"use strict";t.d(n,"a",(function(){return l})),t.d(n,"b",(function(){return b}));var o=t(0),i=t.n(o);function r(e,n,t){return n in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t,e}function a(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);n&&(o=o.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,o)}return t}function c(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?a(Object(t),!0).forEach((function(n){r(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):a(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}))}return e}function s(e,n){if(null==e)return{};var t,o,i=function(e,n){if(null==e)return{};var t,o,i={},r=Object.keys(e);for(o=0;o<r.length;o++)t=r[o],n.indexOf(t)>=0||(i[t]=e[t]);return i}(e,n);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);for(o=0;o<r.length;o++)t=r[o],n.indexOf(t)>=0||Object.prototype.propertyIsEnumerable.call(e,t)&&(i[t]=e[t])}return i}var p=i.a.createContext({}),u=function(e){var n=i.a.useContext(p),t=n;return e&&(t="function"==typeof e?e(n):c(c({},n),e)),t},l=function(e){var n=u(e.components);return i.a.createElement(p.Provider,{value:n},e.children)},m={inlineCode:"code",wrapper:function(e){var n=e.children;return i.a.createElement(i.a.Fragment,{},n)}},f=i.a.forwardRef((function(e,n){var t=e.components,o=e.mdxType,r=e.originalType,a=e.parentName,p=s(e,["components","mdxType","originalType","parentName"]),l=u(t),f=o,b=l["".concat(a,".").concat(f)]||l[f]||m[f]||r;return t?i.a.createElement(b,c(c({ref:n},p),{},{components:t})):i.a.createElement(b,c({ref:n},p))}));function b(e,n){var t=arguments,o=n&&n.mdxType;if("string"==typeof e||o){var r=t.length,a=new Array(r);a[0]=f;var c={};for(var s in n)hasOwnProperty.call(n,s)&&(c[s]=n[s]);c.originalType=e,c.mdxType="string"==typeof e?e:o,a[1]=c;for(var p=2;p<r;p++)a[p]=t[p];return i.a.createElement.apply(null,a)}return i.a.createElement.apply(null,t)}f.displayName="MDXCreateElement"}}]);